

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Step-49 &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'step-49';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Step-53" href="step-53.html" />
    <link rel="prev" title="Notebooks with MyST Markdown" href="markdown-notebooks.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="My sample book - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="My sample book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="markdown.html">Markdown Files</a></li>
<li class="toctree-l1"><a class="reference internal" href="markdown-notebooks.html">Notebooks with MyST Markdown</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Step-49</a></li>
<li class="toctree-l1"><a class="reference internal" href="step-53.html">Step-53</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fstep-49.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/step-49.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Step-49</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python-initialization">Python initialization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-concerns-about-meshes">General concerns about meshes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-create-meshes">How to create meshes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#using-grid-generators">Using Grid Generators</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-from-external-programs">Importing from external programs</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modifying-a-mesh">Modifying a Mesh</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#transformations">Transformations</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-meshes">Merging Meshes</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#moving-vertices">Moving Vertices</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#extruding-meshes">Extruding Meshes</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#after-you-have-a-coarse-mesh">After you have a coarse mesh</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps-curved-cells">Next steps: Curved Cells</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="step-49">
<h1>Step-49<a class="headerlink" href="#step-49" title="Permalink to this heading">#</a></h1>
<p>This is a replica of <a class="reference external" href="https://www.dealii.org/current/doxygen/deal.II/step_49.html">step-49</a> C++ tutorial program. However, here we will use the deal.II Python interface to achieve the same.</p>
<p>Not all of the material is replicated since some parts of the original C++ tutorial are only relevant when using C++. Furthermore, in contrast to the C++ program, here we will take advantage of Jupyter notebook format and do coding and visualization in place.</p>
<p><em>This notebook is contributed by Alexander Grayver, 2020</em></p>
<section id="python-initialization">
<h2>Python initialization<a class="headerlink" href="#python-initialization" title="Permalink to this heading">#</a></h2>
<p>Provided the deal.II was compiled with the python wrappers, we can import the module <strong>PyDealII</strong>. Note that it is only a shell and importing it will only allow you to call</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">PyDealII</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>PyDealII</strong> is composed of two libraries:</p>
<ul class="simple">
<li><p><strong>PyDealII.Debug</strong> which uses the debug version of <strong>deal.II</strong></p></li>
<li><p><strong>PyDealII.Release</strong> which uses the release version of <strong>deal.II</strong></p></li>
</ul>
<p>Let’s us import the release version of the library and give it the shortname <strong>dealii</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">PyDealII.Release</span> <span class="k">as</span> <span class="nn">dealii</span>
</pre></div>
</div>
</div>
</div>
<p>In addition, we will import a few widely used python packages</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<p>Finally, here are a couple of functions, which we will use to plot a triangulation or print some information about it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Polygon</span>
<span class="kn">from</span> <span class="nn">matplotlib.collections</span> <span class="kn">import</span> <span class="n">PatchCollection</span>

<span class="k">def</span> <span class="nf">plot_triangulation</span><span class="p">(</span><span class="n">triangulation</span><span class="p">,</span> <span class="n">color_scheme</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">patches</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cell_id</span> <span class="o">=</span> <span class="mi">0</span> 
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">triangulation</span><span class="o">.</span><span class="n">active_cells</span><span class="p">():</span>
        <span class="n">quad_vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="c1"># The shift variable is used to reorder the vertices because</span>
        <span class="c1"># deal.II and matplotlib require different ordering</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">vertex</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">get_vertex</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">quad_vertices</span><span class="p">[</span><span class="n">shift</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vertex</span><span class="o">.</span><span class="n">x</span>
            <span class="n">quad_vertices</span><span class="p">[</span><span class="n">shift</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vertex</span><span class="o">.</span><span class="n">y</span>
        <span class="n">quad</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">quad_vertices</span><span class="p">,</span> <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">patches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">quad</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">color_scheme</span><span class="p">:</span>
            <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">color_scheme</span><span class="p">(</span><span class="n">cell</span><span class="p">))</span>

        <span class="n">cell_id</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">PatchCollection</span><span class="p">(</span><span class="n">patches</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>  
    <span class="n">p</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">colors</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">autolim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">autoscale_view</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>You don’t need to understand internals of these functions, they are used as mere helpers here.</p>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>This tutorial is an extension to <a class="reference external" href="https://www.dealii.org/current/doxygen/deal.II/step_1.html">step-1</a> and demonstrates several ways to obtain more involved meshes than the ones shown there.</p>
<p>Generating complex geometries is a challenging task, especially in three space dimensions. We will discuss several ways to do this, but this list is not exhaustive. Additionally, there is not one approach that fits all problems.</p>
<p>This example program shows some of ways to create and modify meshes for computations and outputs them as .vtu files in much the same way as we do in <a class="reference external" href="https://www.dealii.org/current/doxygen/deal.II/step_1.html">step-1</a>. No other computations or adaptive refinements are done; the idea is that you can use the techniques used here as building blocks in other, more involved simulators. Please note that the example program does not show all the ways to generate meshes that are discussed in this introduction.</p>
<section id="general-concerns-about-meshes">
<h3>General concerns about meshes<a class="headerlink" href="#general-concerns-about-meshes" title="Permalink to this heading">#</a></h3>
<p>When you use adaptive mesh refinement, you definitely want the initial mesh to be as coarse as possible. The reason is that you can make it as fine as you want using adaptive refinement as long as you have memory and CPU time available. However, this requires that you don’t waste mesh cells in parts of the domain where they don’t pay off. As a consequence, you don’t want to start with a mesh that is too fine to start with, because that takes up a good part of your cell budget already, and because you can’t coarsen away cells that are in the initial mesh.</p>
<p>That said, your mesh needs to capture the given geometry adequately.</p>
</section>
<section id="how-to-create-meshes">
<h3>How to create meshes<a class="headerlink" href="#how-to-create-meshes" title="Permalink to this heading">#</a></h3>
<p>There are several ways to create an initial mesh. Meshes can be modified or combined in many ways as discussed later on.</p>
<section id="using-grid-generators">
<h4>Using Grid Generators<a class="headerlink" href="#using-grid-generators" title="Permalink to this heading">#</a></h4>
<p>The easiest way to generate meshes is to use the functions from the namespace <a class="reference external" href="https://www.dealii.org/current/doxygen/deal.II/namespaceGridGenerator.html">GridGenerator</a>. Python interface currently supports the following functions</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s1">&#39;generate_*&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">match</span><span class="p">,</span> <span class="nb">dir</span><span class="p">(</span><span class="n">dealii</span><span class="o">.</span><span class="n">Triangulation</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;generate_cheese&#39;,
 &#39;generate_enclosed_hyper_cube&#39;,
 &#39;generate_fixed_subdivided_parallelepiped&#39;,
 &#39;generate_general_cell&#39;,
 &#39;generate_half_hyper_ball&#39;,
 &#39;generate_hyper_ball&#39;,
 &#39;generate_hyper_cube&#39;,
 &#39;generate_hyper_cube_with_cylindrical_hole&#39;,
 &#39;generate_hyper_rectangle&#39;,
 &#39;generate_hyper_shell&#39;,
 &#39;generate_hyper_sphere&#39;,
 &#39;generate_parallelepiped&#39;,
 &#39;generate_parallelogram&#39;,
 &#39;generate_quarter_hyper_ball&#39;,
 &#39;generate_simplex&#39;,
 &#39;generate_subdivided_hyper_cube&#39;,
 &#39;generate_subdivided_hyper_rectangle&#39;,
 &#39;generate_subdivided_material_hyper_rectangle&#39;,
 &#39;generate_subdivided_steps_hyper_rectangle&#39;,
 &#39;generate_varying_subdivided_parallelepiped&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="importing-from-external-programs">
<h4>Importing from external programs<a class="headerlink" href="#importing-from-external-programs" title="Permalink to this heading">#</a></h4>
<p>The original C++ class <a class="reference external" href="https://www.dealii.org/current/doxygen/deal.II/classGridIn.html">GridIn</a> can read many different mesh formats from a file from disk. In PyDealII, GridIn functions are called via the <em>Triangulation.read</em> method</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">dealii</span><span class="o">.</span><span class="n">Triangulation</span><span class="o">.</span><span class="n">read</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on built-in function read:

read(...)
    read( (Triangulation)self, (str)filename, (str)format) -&gt; None :
        Read a mesh from the file according to the given data format.          
        The possible formats are:                                              
          - msh                                                                
          - vtk
</pre></div>
</div>
</div>
</div>
<p>Meshes can be generated from different tools like <a class="reference external" href="http://gmsh.info/">gmsh</a>, <a class="reference external" href="https://lagrit.lanl.gov/">lagrit</a> and <a class="reference external" href="https://cubit.sandia.gov/">cubit</a>. See the documentation of <a class="reference external" href="https://www.dealii.org/current/doxygen/deal.II/classGridIn.html">GridIn</a> for more information. The problem is that deal.II needs meshes that only consist of quadrilaterals and hexahedra – tetrahedral meshes won’t work (this means tools like tetgen can not be used directly).</p>
<p>We will describe a possible workflow using Gmsh. Gmsh is the smallest and most quickly set up open source tool we are aware of. It can generate unstructured 2d quad meshes. In 3d, it can extrude 2d meshes to get hexahedral meshes; 3D meshing of unstructured geometry into hexahedra is possible, though there are some issues with the quality of these meshes that imply that these meshes only sometimes work in deal.II.</p>
<p>In Gmsh, a mesh is fundamentally described in a text-based .geo file whose format can contain computations, loops, variables, etc. This format is quite flexible in allowing the description of complex geometries. The mesh is then generated from a surface representation, which is built from a list of line loops, which is built from a list of lines, which are in turn built from points. The .geo script can be written and edited by hand or it can be generated automatically by creating objects graphically inside Gmsh. In many cases it is best to combine both approaches. The file can be easily reloaded by pressing “reload” under the “Geometry” tab if you want to write it by hand and see the effects in the graphical user interface of gmsh.</p>
<p>This tutorial contains an example .geo file that describes a box with two objects cut out in the interior. This is how <em>example.geo</em> looks like in Gmsh (displaying the boundary indicators as well as the mesh discussed further down below):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%html</span>
<span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://www.dealii.org/images/steps/developer/step-49.gmsh_picture.png&quot;</span><span class="p">/&gt;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><img src="https://www.dealii.org/images/steps/developer/step-49.gmsh_picture.png"/>
</div></div>
</div>
<p>You might want to open the example.geo file in a text editor (it is located in the same directory as the <em><a class="reference external" href="http://step-49.cc">step-49.cc</a></em> source file) to see how it is structured. You can see how the boundary of the domain is composed of a number of lines and how later on we combine several lines into “physical lines” (or “physical surfaces”) that list the logical lines’ numbers. “Physical” object are the ones that carry information about the boundary indicator (see <a class="reference external" href="https://www.dealii.org/developer/doxygen/deal.II/DEALGlossary.html#GlossBoundaryIndicator">this glossary entry</a>).</p>
<p><strong>Note</strong></p>
<blockquote>
<div><p>It is important that this file contain “physical lines” and “physical surfaces”. These give the boundary indicators and material ids for use in deal.II. Without these physical entities, nothing will be imported into deal.II.</p>
</div></blockquote>
<p>deal.II’s GridIn class can read the .msh format written by Gmsh and that contains a mesh created for the geometry described by the .geo file. You generate the .msh from the .geo by running the commands</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">gmsh</span><span class="w"> </span><span class="o">-</span><span class="mf">2</span><span class="w"> </span><span class="nx">example</span><span class="p">.</span><span class="nx">geo</span>
</pre></div>
</div>
<p>on the command line, or by clicking “Mesh” and then “2D” inside Gmsh after loading the file. Now, we can read in the mesh from the .msh file and visualize using the python bindings:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!(</span>ls<span class="o">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>_build	     intro.md		    poetry.lock       step-53.ipynb
_config.yml  logo.png		    pyproject.toml    topography.txt.gz
_toc.yml     markdown-notebooks.md  references.bib
example.geo  markdown.md	    requirements.txt
example.msh  notebooks.ipynb	    step-49.ipynb
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">triangulation</span> <span class="o">=</span> <span class="n">dealii</span><span class="o">.</span><span class="n">Triangulation</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="s1">&#39;2D&#39;</span><span class="p">)</span>
<span class="n">triangulation</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;example.msh&#39;</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;msh&#39;</span><span class="p">)</span>
<span class="n">plot_triangulation</span><span class="p">(</span><span class="n">triangulation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8edd1ec16a5eb7a6bcb96d15412a257cbb4e8a0203f6ae629d1a8c773db89020.png" src="_images/8edd1ec16a5eb7a6bcb96d15412a257cbb4e8a0203f6ae629d1a8c773db89020.png" />
</div>
</div>
<p><strong>Note</strong></p>
<blockquote>
<div><p>gmsh has a number of other interfaces by which one can describe geometries to it. In particular, it has the ability to interface with scripting languages like Python and Julia, but it can also be scripted from C++. These interfaces are useful if one doesn’t just want to generate a mesh for a single geometry (in which case the graphical interface or, in simple cases, a hand-written .geo file is probably the simplest approach), but instead wants to do parametric studies over the geometry for which it is necessary to generate many meshes for geometries that differ in certain parameters. Another case where this is useful is if there is already a CAD geometry for which one only needs a mesh; indeed, this can be done from within deal.II using the <a class="reference external" href="https://www.dealii.org/current/doxygen/deal.II/namespaceGmsh.html#ab65eb217368d006b66bcfcc6fa0f2894">Gmsh::create_triangulation_from_boundary_curve()</a> function.</p>
</div></blockquote>
</section>
</section>
<section id="modifying-a-mesh">
<h3>Modifying a Mesh<a class="headerlink" href="#modifying-a-mesh" title="Permalink to this heading">#</a></h3>
<p>After acquiring one (or several) meshes in the ways described above, there are many ways to manipulate them before using them in a finite element computation.</p>
<section id="transformations">
<h4>Transformations<a class="headerlink" href="#transformations" title="Permalink to this heading">#</a></h4>
<p>The function <em>Triangulation.transform</em> allows you to transform the vertices of a given mesh using a smooth function. An example of its use is also given in the results section of <a class="reference external" href="https://www.dealii.org/current/doxygen/deal.II/step_38.html">step-38</a> but let us show a simpler example here. Using the code below, we perturb the <em>y</em> coordinate of a mesh with a sine curve.</p>
<p>First, let us create a triangulation</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">triangulation</span> <span class="o">=</span> <span class="n">dealii</span><span class="o">.</span><span class="n">Triangulation</span><span class="p">(</span><span class="s1">&#39;2D&#39;</span><span class="p">)</span>
<span class="n">triangulation</span><span class="o">.</span><span class="n">generate_subdivided_hyper_rectangle</span><span class="p">(</span><span class="n">repetitions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>\
                                                  <span class="n">p1</span> <span class="o">=</span> <span class="n">dealii</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>\
                                                  <span class="n">p2</span> <span class="o">=</span> <span class="n">dealii</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="n">plot_triangulation</span><span class="p">(</span><span class="n">triangulation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3a80dd3d18a7b10178bfd5f4166703f09fb1f8eee8b5b44466538d5e29f99c6d.png" src="_images/3a80dd3d18a7b10178bfd5f4166703f09fb1f8eee8b5b44466538d5e29f99c6d.png" />
</div>
</div>
<p>Next, we define a lambda function that takes a point (a list of size <em>dim</em> with coordinates), transforms it according to the formula <span class="math notranslate nohighlight">\((x,y) \rightarrow (x, y + \sin(\pi x / 5))\)</span> and returns the result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sine_y_transform</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mf">5.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<p>Now, apply this transformation and plot the result:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">triangulation</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">transformation</span> <span class="o">=</span> <span class="n">sine_y_transform</span><span class="p">)</span>
<span class="n">plot_triangulation</span><span class="p">(</span><span class="n">triangulation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3b3434894e269b20b55bc0d227db728c5d8dc5f7970807397852d7ef950bf2a1.png" src="_images/3b3434894e269b20b55bc0d227db728c5d8dc5f7970807397852d7ef950bf2a1.png" />
</div>
</div>
<p>Similarly, we can transform a regularly refined unit square to a wall-adapted mesh in y direction using the formula <span class="math notranslate nohighlight">\((x,y) \rightarrow (x, \tanh(2y) / \tanh(2))\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">triangulation</span> <span class="o">=</span> <span class="n">dealii</span><span class="o">.</span><span class="n">Triangulation</span><span class="p">(</span><span class="s1">&#39;2D&#39;</span><span class="p">)</span>
<span class="n">triangulation</span><span class="o">.</span><span class="n">generate_subdivided_hyper_rectangle</span><span class="p">(</span><span class="n">repetitions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>\
                                                  <span class="n">p1</span> <span class="o">=</span> <span class="n">dealii</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>\
                                                  <span class="n">p2</span> <span class="o">=</span> <span class="n">dealii</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="n">plot_triangulation</span><span class="p">(</span><span class="n">triangulation</span><span class="p">)</span>

<span class="n">tanh_y_transform</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">math</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="mf">2.</span><span class="p">)]</span>
<span class="n">triangulation</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">transformation</span> <span class="o">=</span> <span class="n">tanh_y_transform</span><span class="p">)</span>

<span class="n">plot_triangulation</span><span class="p">(</span><span class="n">triangulation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3c4fa7810174529914b3bcbd963fbeb21e023d2011cacb6fe738bae294a26a9b.png" src="_images/3c4fa7810174529914b3bcbd963fbeb21e023d2011cacb6fe738bae294a26a9b.png" />
<img alt="_images/51da4eb8cec745eb3c5cc027ddbd30a0a4593c5670297d0b68e7315370036e10.png" src="_images/51da4eb8cec745eb3c5cc027ddbd30a0a4593c5670297d0b68e7315370036e10.png" />
</div>
</div>
<p>Finally, the function <em>distort_random</em> allows you to move vertices in the mesh (optionally ignoring boundary nodes) by a random amount. This is demonstrated in below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">triangulation</span> <span class="o">=</span> <span class="n">dealii</span><span class="o">.</span><span class="n">Triangulation</span><span class="p">(</span><span class="s1">&#39;2D&#39;</span><span class="p">)</span>
<span class="n">triangulation</span><span class="o">.</span><span class="n">generate_subdivided_hyper_rectangle</span><span class="p">(</span><span class="n">repetitions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>\
                                                  <span class="n">p1</span> <span class="o">=</span> <span class="n">dealii</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span>\
                                                  <span class="n">p2</span> <span class="o">=</span> <span class="n">dealii</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="n">plot_triangulation</span><span class="p">(</span><span class="n">triangulation</span><span class="p">)</span>

<span class="n">triangulation</span><span class="o">.</span><span class="n">distort_random</span><span class="p">(</span><span class="n">factor</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">keep_boundary</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">plot_triangulation</span><span class="p">(</span><span class="n">triangulation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d8a1c1c3f6000824a8cc308c24490c891d70b77a3c35a87c31c25c08daba8dd8.png" src="_images/d8a1c1c3f6000824a8cc308c24490c891d70b77a3c35a87c31c25c08daba8dd8.png" />
<img alt="_images/f8724c6d6bdf05c6117ee5267b6abf0c547978df78fcd2e6a1668a288dc4a31c.png" src="_images/f8724c6d6bdf05c6117ee5267b6abf0c547978df78fcd2e6a1668a288dc4a31c.png" />
</div>
</div>
<p>This function is primarily intended to negate some of the superconvergence effects one gets when studying convergence on regular meshes, as well as to suppress some optimizations in deal.II that can exploit the fact that cells are similar in shape. (Superconvergence refers to the fact that if a mesh has certain symmetries – for example, if the edges running into a vertex are symmetric to this vertex, and if this is so for all vertices of a cell – that the solution is then often convergent with a higher order than one would have expected from the usual error analysis. In the end, this is a result of the fact that if one were to make a Taylor expansion of the error, the symmetry leads to the fact that the expected next term of the expansion happens to be zero, and the error order is determined by the second next term. A distorted mesh does not have these symmetries and consequently the error reflects what one will see when solving the equation on any kind of mesh, rather than showing something that is only reflective of a particular situation.)</p>
</section>
<section id="merging-meshes">
<h4>Merging Meshes<a class="headerlink" href="#merging-meshes" title="Permalink to this heading">#</a></h4>
<p>The method <em>Triangulation.merge_triangulations</em> allows you to merge two given <em>Triangulation</em> objects into a single one. For this to work, the vertices of the shared edge or face have to match exactly. Lining up the two meshes can be achieved using <em>Triangulation.shift</em> and <em>Triangulation.scale</em>. In the code section below, we merge a square with a round hole. The method <em>Triangulation.subdivided_hyper_rectangle</em> allows you to specify the number of repetitions and the positions of the corners, so there is no need to shift the triangulation manually here. You should inspect the mesh graphically to make sure that cells line up correctly and no unpaired nodes exist in the merged Triangulation.</p>
<p>Create and plot the input meshes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tria_1</span> <span class="o">=</span> <span class="n">dealii</span><span class="o">.</span><span class="n">Triangulation</span><span class="p">(</span><span class="s1">&#39;2D&#39;</span><span class="p">)</span>
<span class="n">tria_1</span><span class="o">.</span><span class="n">generate_hyper_cube_with_cylindrical_hole</span><span class="p">(</span><span class="n">inner_radius</span> <span class="o">=</span> <span class="mf">.25</span><span class="p">,</span> <span class="n">outer_radius</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">)</span>

<span class="n">plot_triangulation</span><span class="p">(</span><span class="n">tria_1</span><span class="p">)</span>

<span class="n">tria_2</span> <span class="o">=</span> <span class="n">dealii</span><span class="o">.</span><span class="n">Triangulation</span><span class="p">(</span><span class="s1">&#39;2D&#39;</span><span class="p">)</span>
<span class="n">tria_2</span><span class="o">.</span><span class="n">generate_subdivided_hyper_rectangle</span><span class="p">(</span><span class="n">repetitions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>\
                                           <span class="n">p1</span> <span class="o">=</span> <span class="n">dealii</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">]),</span>\
                                           <span class="n">p2</span> <span class="o">=</span> <span class="n">dealii</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]))</span>
<span class="n">plot_triangulation</span><span class="p">(</span><span class="n">tria_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1db961043f5fc9c988daf4191cb8379a7b09d01250896c0005dbec16929affb3.png" src="_images/1db961043f5fc9c988daf4191cb8379a7b09d01250896c0005dbec16929affb3.png" />
<img alt="_images/4a5b947e5f2c9479dca912e6b4388fdd2097cde37ed2596535a53a76f007090e.png" src="_images/4a5b947e5f2c9479dca912e6b4388fdd2097cde37ed2596535a53a76f007090e.png" />
</div>
</div>
<p>Now merge triangulations and plot the resulting mesh</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tria_merged</span> <span class="o">=</span> <span class="n">dealii</span><span class="o">.</span><span class="n">Triangulation</span><span class="p">(</span><span class="s1">&#39;2D&#39;</span><span class="p">)</span>
<span class="n">tria_merged</span><span class="o">.</span><span class="n">merge_triangulations</span><span class="p">([</span><span class="n">tria_1</span><span class="p">,</span> <span class="n">tria_2</span><span class="p">])</span>
<span class="n">plot_triangulation</span><span class="p">(</span><span class="n">tria_merged</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c335f2c041d8534d0909073ac3591683f7b6e79f66ac03a400bcf93f71f745d1.png" src="_images/c335f2c041d8534d0909073ac3591683f7b6e79f66ac03a400bcf93f71f745d1.png" />
</div>
</div>
</section>
<section id="moving-vertices">
<h4>Moving Vertices<a class="headerlink" href="#moving-vertices" title="Permalink to this heading">#</a></h4>
<p>Here we show the ability to pick individual vertices and move them around in an existing mesh. Note that this has the potential to produce degenerate or inverted cells and you shouldn’t expect anything useful to come of using such meshes. Here, we create a box with a cylindrical hole that is not exactly centered by moving the top vertices upwards:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">triangulation</span> <span class="o">=</span> <span class="n">dealii</span><span class="o">.</span><span class="n">Triangulation</span><span class="p">(</span><span class="s1">&#39;2D&#39;</span><span class="p">)</span>
<span class="n">triangulation</span><span class="o">.</span><span class="n">generate_hyper_cube_with_cylindrical_hole</span><span class="p">(</span><span class="n">inner_radius</span> <span class="o">=</span> <span class="mf">.25</span><span class="p">,</span> <span class="n">outer_radius</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">)</span>

<span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">triangulation</span><span class="o">.</span><span class="n">active_cells</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">get_vertex</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        
        <span class="k">if</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-5</span><span class="p">):</span>
            <span class="n">v</span><span class="o">.</span><span class="n">y</span> <span class="o">+=</span> <span class="mf">0.5</span>
            
        <span class="n">cell</span><span class="o">.</span><span class="n">set_vertex</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        
<span class="n">triangulation</span><span class="o">.</span><span class="n">refine_global</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plot_triangulation</span><span class="p">(</span><span class="n">triangulation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/79c931b55c961a59bf71d7e28d1dde3a4dd7a7346e1a1e88da6f08d2444b5b21.png" src="_images/79c931b55c961a59bf71d7e28d1dde3a4dd7a7346e1a1e88da6f08d2444b5b21.png" />
</div>
</div>
</section>
<section id="extruding-meshes">
<h4>Extruding Meshes<a class="headerlink" href="#extruding-meshes" title="Permalink to this heading">#</a></h4>
<p>If you need a 3d mesh that can be created by extruding a given 2d mesh (that can be created in any of the ways given above), you can use the function <em>Triangulation.extrude_triangulation</em>. See code below for an example. Note that for this particular case, the given result could also be achieved using the 3d version of <em>Triangulation.generate_hyper_cube_with_cylindrical_hole</em>. The main usage is a 2d mesh, generated for example with Gmsh, that is read in from a .msh file as described above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tria</span> <span class="o">=</span> <span class="n">dealii</span><span class="o">.</span><span class="n">Triangulation</span><span class="p">(</span><span class="s1">&#39;2D&#39;</span><span class="p">)</span>
<span class="n">tria</span><span class="o">.</span><span class="n">generate_hyper_cube_with_cylindrical_hole</span><span class="p">(</span><span class="n">inner_radius</span> <span class="o">=</span> <span class="mf">.25</span><span class="p">,</span> <span class="n">outer_radius</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">)</span>

<span class="n">tria_extruded</span> <span class="o">=</span> <span class="n">dealii</span><span class="o">.</span><span class="n">Triangulation</span><span class="p">(</span><span class="s1">&#39;3D&#39;</span><span class="p">)</span>
<span class="n">tria</span><span class="o">.</span><span class="n">extrude_triangulation</span><span class="p">(</span><span class="n">n_slices</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">depth</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">tria_out</span> <span class="o">=</span> <span class="n">tria_extruded</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Since we cannot easily visualize 3d mesh, let’s save it in the EPS format and then plot the image (this requires <em>pillow</em> package to be installed)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tria_extruded</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;extruded_mesh.eps&#39;</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;eps&#39;</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;extruded_mesh.eps&#39;</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7f16387d94d0&gt;
</pre></div>
</div>
<img alt="_images/7a0aae0b3446182a850c6a18fdda83a0005f3c650b095a08e19b0f616ddac3c0.png" src="_images/7a0aae0b3446182a850c6a18fdda83a0005f3c650b095a08e19b0f616ddac3c0.png" />
</div>
</div>
</section>
<section id="after-you-have-a-coarse-mesh">
<h4>After you have a coarse mesh<a class="headerlink" href="#after-you-have-a-coarse-mesh" title="Permalink to this heading">#</a></h4>
<p>Creating a coarse mesh using the methods discussed above is only the first step. When you have it, it will typically serve as the basis for further mesh refinement. This is not difficult — in fact, there is nothing else to do — if your geometry consists of only straight faces. However, this is often not the case if you have a more complex geometry and more steps than just creating the mesh are necessary. We will go over some of these steps in the section below.</p>
</section>
</section>
<section id="next-steps-curved-cells">
<h3>Next steps: Curved Cells<a class="headerlink" href="#next-steps-curved-cells" title="Permalink to this heading">#</a></h3>
<p>As mentioned in the introduction, creating a coarse mesh using the methods discussed here is only the first step. In order to refine a mesh, the <em>Triangulation</em> needs to know where to put new vertices on the mid-points of edges, faces, and cells. By default, these new points will be placed at the arithmetic mean of the surrounding points, but this isn’t what you want if you need curved boundaries that aren’t already adequately resolved by the coarse mesh.</p>
<p>To illustrate this process in more detail, let us consider an example created by Yuhan Zhou as part of a 2013 semester project at Texas A&amp;M University. The goal was to generate (and use) a geometry that describes a microstructured electric device. In a CAD program, the geometry looks like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%html</span>
<span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://www.dealii.org/images/steps/developer/step-49.yuhan.1.png&quot;</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><img src="https://www.dealii.org/images/steps/developer/step-49.yuhan.1.png">
</div></div>
</div>
<p>In the following, we will walk you through the entire process of creating a mesh for this geometry, including a number of common pitfalls by showing the things that can go wrong.</p>
<p>The first step in getting there was to create a coarse mesh, which was done by creating a 2d coarse mesh for each of cross sections, extruding them into the third direction, and gluing them together. The following code does this, using the techniques previously described:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># def create_3d_grid():</span>
<span class="c1">#     # Generate first cross section</span>
<span class="c1">#     vertices_1 = [[-1.5, 0.], [-0.5, 0.], [0.5, 0.], [1.5, 0.],\</span>
<span class="c1">#               [-1.5, 1.5], [-0.5, 1.5], [0.5, 1.5], [1.5, 1.5],\</span>
<span class="c1">#               [-1.5, 3.], [-0.5, 3.], [0.5, 3.], [1.5, 3.],\</span>
<span class="c1">#               [-0.5, 3 + 0.5 * math.sqrt(3)],\</span>
<span class="c1">#               [0.5, 3 + 0.5 * math.sqrt(3)],\</span>
<span class="c1">#               [-0.75, 3 + 0.75 * math.sqrt(3)],\</span>
<span class="c1">#               [0.75, 3 + 0.75 * math.sqrt(3)]]</span>

<span class="c1">#     cell_vertices_1 = [[0, 1, 4, 5],</span>
<span class="c1">#                    [1, 2, 5, 6],</span>
<span class="c1">#                    [3, 7, 2, 6],</span>
<span class="c1">#                    [4, 5, 8, 9],</span>
<span class="c1">#                    [5, 6, 9, 10],</span>
<span class="c1">#                    [7, 11, 6, 10],</span>
<span class="c1">#                    [8, 9, 14, 12],</span>
<span class="c1">#                    [9, 10, 12, 13],</span>
<span class="c1">#                    [11, 15, 10, 13],</span>
<span class="c1">#                    [14, 12, 15, 13]]</span>

<span class="c1">#     # Given a list of points and how vertices connect to cells, create a mesh.</span>
<span class="c1">#     tria_2d_1 = dealii.Triangulation(&#39;2D&#39;)</span>
<span class="c1">#     tria_2d_1.create_triangulation(vertices_1, cell_vertices_1)</span>

<span class="c1">#     # Then extrude it into a 3d piece</span>
<span class="c1">#     tria_3d_1 = dealii.Triangulation(&#39;3D&#39;)</span>
<span class="c1">#     tria_2d_1.extrude_triangulation(n_slices = 5, depth = 2.5, tria_out = tria_3d_1)</span>

<span class="c1">#     # Now do the same with the second volume</span>
<span class="c1">#     vertices_2 = [[-2.5, 0.],</span>
<span class="c1">#               [-1.5, 0.],</span>
<span class="c1">#               [-0.5, 0.],</span>
<span class="c1">#               [0.5, 0.],</span>
<span class="c1">#               [1.5, 0.],</span>
<span class="c1">#               [2.5, 0.],</span>
<span class="c1">#               [-2.5, 1.5],</span>
<span class="c1">#               [-1.5, 1.5],</span>
<span class="c1">#               [-0.5, 1.5],</span>
<span class="c1">#               [0.5, 1.5],</span>
<span class="c1">#               [1.5, 1.5],</span>
<span class="c1">#               [2.5, 1.5],</span>
<span class="c1">#               [-2.5, 3.],</span>
<span class="c1">#               [-1.5, 3.],</span>
<span class="c1">#               [-0.5, 3.],</span>
<span class="c1">#               [0.5, 3.],</span>
<span class="c1">#               [1.5, 3.],</span>
<span class="c1">#               [2.5, 3.],</span>
<span class="c1">#               [-0.5, 3. + 0.5 * math.sqrt(3)],</span>
<span class="c1">#               [0.5, 3. + 0.5 * math.sqrt(3)],</span>
<span class="c1">#               [-0.75, 3. + 0.75 * math.sqrt(3)],</span>
<span class="c1">#               [0.75, 3. + 0.75 * math.sqrt(3)],</span>
<span class="c1">#               [-1.25, 3. + 1.25 * math.sqrt(3)],</span>
<span class="c1">#               [1.25, 3. + 1.25 * math.sqrt(3)]]</span>

<span class="c1">#     cell_vertices_2 = [[0, 1, 6, 7],</span>
<span class="c1">#                    [1, 2, 7, 8],</span>
<span class="c1">#                    [2, 3, 8, 9],</span>
<span class="c1">#                    [4, 10, 3, 9],</span>
<span class="c1">#                    [5, 11, 4, 10],</span>
<span class="c1">#                    [6, 7, 12, 13],</span>
<span class="c1">#                    [7, 8, 13, 14],</span>
<span class="c1">#                    [8, 9, 14, 15],</span>
<span class="c1">#                    [10, 16, 9, 15],</span>
<span class="c1">#                    [11, 17, 10, 16],</span>
<span class="c1">#                    [12, 13, 22, 20],</span>
<span class="c1">#                    [13, 14, 20, 18],</span>
<span class="c1">#                    [14, 15, 18, 19],</span>
<span class="c1">#                    [16, 21, 15, 19],</span>
<span class="c1">#                    [17, 23, 16, 21],</span>
<span class="c1">#                    [20, 18, 21, 19],</span>
<span class="c1">#                    [22, 20, 23, 21]]</span>

<span class="c1">#     tria_2d_2 = dealii.Triangulation(&#39;2D&#39;)</span>
<span class="c1">#     tria_2d_2.create_triangulation(vertices_2, cell_vertices_2)</span>

<span class="c1">#     tria_3d_2 = dealii.Triangulation(&#39;3D&#39;)</span>
<span class="c1">#     tria_2d_2.extrude_triangulation(n_slices = 5, depth = 2.5, tria_out = tria_3d_2)</span>

<span class="c1">#     # Also shift this triangulation in the z-direction so that it matches the</span>
<span class="c1">#     # end face of the first part</span>
<span class="c1">#     tria_3d_2.shift([0, 0, 2.5])</span>

<span class="c1">#     # Now first merge these two pieces, then shift the first piece in</span>
<span class="c1">#     # z-direction beyond the second, and merge the shifted piece with the two</span>
<span class="c1">#     # previously merged one into the final one:</span>
<span class="c1">#     tria_3d_tmp = dealii.Triangulation(&#39;3D&#39;)</span>
<span class="c1">#     tria_3d_tmp.merge_triangulations(tria_3d_1, tria_3d_2)</span>

<span class="c1">#     tria_3d_1.shift([0, 0, 5.])</span>

<span class="c1">#     triangulation = dealii.Triangulation(&#39;3D&#39;)</span>
<span class="c1">#     triangulation.merge_triangulations(tria_3d_tmp, tria_3d_1)</span>

<span class="c1">#     return triangulation</span>

<span class="c1"># triangulation = create_3d_grid()</span>
<span class="c1"># # triangulation.write(&#39;coarse.vtk&#39;, &#39;vtk&#39;)</span>
</pre></div>
</div>
</div>
</div>
<p>This creates the following mesh:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%html</span>
<span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://www.dealii.org/images/steps/developer/step-49.yuhan.8.png&quot;</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><img src="https://www.dealii.org/images/steps/developer/step-49.yuhan.8.png">
</div></div>
</div>
<p>This mesh has the right general shape, but the top cells are now polygonal: their edges are no longer along circles and we do not have a very accurate representation of the original geometry. The next step is to teach the top part of the domain that it should be curved. Put another way, all calculations done on the top boundary cells should be done in cylindrical coordinates rather than Cartesian coordinates. We can do this by creating a <em>CylindricalManifold</em> object and associating it with the cells above <span class="math notranslate nohighlight">\(y=3\)</span>. This way, when we refine the cells on top, we will place new points along concentric circles instead of straight lines.</p>
<p>In this case, with the CylindricalManifold constructed below, the geodesics are arcs along circles orthogonal to the <span class="math notranslate nohighlight">\(z\)</span>-axis centered along the line <span class="math notranslate nohighlight">\((0,3,z)\)</span>.</p>
<p>Since all three top parts of the domain use the same geodesics, we will mark all cells with centers above the <span class="math notranslate nohighlight">\(y=3\)</span> line as being cylindrical in nature:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># triangulation = create_3d_grid()</span>

<span class="c1"># cylinder = dealii.Manifold(dim = 3, spacedim = 3)</span>
<span class="c1"># cylinder.create_cylindrical(direction = [0., 0., 1.], axial_point = [0, 3., 0.])</span>

<span class="c1"># cylinder_id = 8</span>

<span class="c1"># triangulation.set_manifold(number = cylinder_id, manifold = cylinder)</span>

<span class="c1"># for cell in triangulation.active_cells():</span>
<span class="c1">#     if cell.center().y &gt;= 3.:</span>
<span class="c1">#         cell.set_all_manifold_ids(cylinder_id)</span>
        
<span class="c1"># triangulation.refine_global(1)</span>

<span class="c1"># triangulation.write(&#39;coarse.vtk&#39;, &#39;vtk&#39;)</span>
</pre></div>
</div>
</div>
</div>
<p>With this code, we get a mesh that looks like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%html</span>
<span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://www.dealii.org/images/steps/developer/step-49.yuhan.9.png&quot;</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><img src="https://www.dealii.org/images/steps/developer/step-49.yuhan.9.png">
</div></div>
</div>
<p>This change fixes the boundary but creates a new problem: the cells adjacent to the cylinder’s axis are badly distorted. We should use Cartesian coordinates for calculations on these central cells to avoid this issue. The cells along the center line all have a face that touches the line <span class="math notranslate nohighlight">\((0,3,z)\)</span> so, to implement this, we go back and overwrite the manifold_ids on these cells to be zero (which is the default):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># triangulation = create_3d_grid()</span>

<span class="c1"># triangulation.set_manifold(number = cylinder_id, manifold = cylinder)</span>

<span class="c1"># for cell in triangulation.active_cells():</span>
<span class="c1">#     if cell.center().y &gt;= 3.:</span>
<span class="c1">#         cell.set_all_manifold_ids(cylinder_id)</span>
        
<span class="c1"># flat_manifold_id = -1</span>
<span class="c1"># for cell in triangulation.active_cells():</span>
<span class="c1">#     for face in cell.faces():</span>
<span class="c1">#         face_center = face.center()</span>
<span class="c1">#         if abs(face_center.x) &lt; 1.0e-5 and\</span>
<span class="c1">#            abs(face_center.y - 3.0) &lt; 1.0e-5:</span>
<span class="c1">#             cell.set_all_manifold_ids(flat_manifold_id)</span>
        
<span class="c1"># triangulation.refine_global(3)</span>
</pre></div>
</div>
</div>
</div>
<p>We can finally save the mesh now:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">triangulation</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;final.vtk&#39;</span><span class="p">,</span> <span class="s1">&#39;vtk&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This gives us a good mesh, where cells at the center of each circle are still Cartesian and cells around the boundary lie along a circle. We can really see the nice detail of the boundary fitted mesh if we refine two more times:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%html</span>
<span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://www.dealii.org/images/steps/developer/step-49.yuhan.11.png&quot;</span><span class="p">&gt;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><img src="https://www.dealii.org/images/steps/developer/step-49.yuhan.11.png">
</div></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="markdown-notebooks.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Notebooks with MyST Markdown</p>
      </div>
    </a>
    <a class="right-next"
       href="step-53.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Step-53</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#python-initialization">Python initialization</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general-concerns-about-meshes">General concerns about meshes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-create-meshes">How to create meshes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#using-grid-generators">Using Grid Generators</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-from-external-programs">Importing from external programs</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modifying-a-mesh">Modifying a Mesh</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#transformations">Transformations</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merging-meshes">Merging Meshes</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#moving-vertices">Moving Vertices</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#extruding-meshes">Extruding Meshes</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#after-you-have-a-coarse-mesh">After you have a coarse mesh</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps-curved-cells">Next steps: Curved Cells</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>